#!/bin/sh

# Kill any existing aplay or qua_player processes and wait
# Wait for processes to actually terminate (max 10 iterations)
pkill -15 -f "aplay|qua_player" 2>/dev/null

count=0
while [ $count -lt 10 ]; do
    if ! pgrep -f "aplay|qua_" >/dev/null 2>&1; then
        break
    fi
    sleep 0.01
    count=$((count + 1))
done

qua_setup "$1"
